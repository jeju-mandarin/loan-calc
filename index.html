<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëŒ€ì¶œ ì´ì ê³„ì‚°ê¸° (ë¹„êµ ê¸°ëŠ¥)</title>
    <style>
        /* (CSS ìŠ¤íƒ€ì¼ì€ ì´ì „ê³¼ ë™ì¼í•©ë‹ˆë‹¤.) */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            display: flex; justify-content: center; align-items: center;
            flex-direction: column; min-height: 100vh;
            background-color: #f0f4f8; margin: 0; padding: 20px 0;
        }
        .container {
            background-color: #ffffff; padding: 25px 30px; border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); text-align: center;
            width: 90%; 
            max-width: 550px; 
        }
        h1 {
            color: #333; margin-top: 0; margin-bottom: 25px;
            font-size: 1.6rem;
        }
        .input-group {
            margin-bottom: 15px; text-align: left;
        }
        .input-group label {
            display: block; margin-bottom: 5px;
            font-weight: 500; color: #555;
        }
        .input-field {
            display: flex; align-items: center;
        }
        .input-field input[type="number"],
        .input-field select {
            width: 100%; flex: 1; padding: 12px; border: 1px solid #ddd;
            border-radius: 5px; font-size: 16px;
            font-family: inherit; background-color: #fff;
            appearance: textfield; 
            text-align: right;
        }
        .input-field input[type="number"]::-webkit-outer-spin-button,
        .input-field input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none; margin: 0;
        }
        .input-field .unit {
            margin-left: 5px; font-size: 16px; color: #333;
            min-width: 35px; text-align: right;
        }
        
        button {
            width: 100%; padding: 12px 20px; background-color: #d9534f;
            color: white; border: none; border-radius: 5px;
            font-size: 16px; font-weight: 500; cursor: pointer;
            transition: background-color 0.2s; margin-top: 10px;
            margin-bottom: 20px;
        }
        button:hover { background-color: #c9302c; }
        
        #result-display {
            margin-top: 25px; background-color: #f9f9f9;
            border: 1px solid #eee; border-radius: 8px;
            padding: 20px; text-align: left;
            display: none;
        }
        .result-row {
            display: flex; justify-content: space-between;
            align-items: center; font-size: 1rem; margin-bottom: 12px;
        }
        .result-row .label { font-weight: 500; color: #555; }
        .result-row .value {
            font-weight: 600; color: #333;
            font-variant-numeric: tabular-nums;
        }
        .result-total {
            border-top: 1px solid #ddd; padding-top: 15px;
            margin-top: 15px; font-size: 1.1rem; font-weight: 600;
        }
        .result-total .value {
            font-size: 1.2rem;
            color: #d9534f;
        }
        
        #comparison-display {
            margin-top: 20px; padding-top: 20px; border-top: 1px dashed #ccc; color: #777; font-size: 0.9rem;
            text-align: left; /* [ìˆ˜ì •] ì „ì²´ ì •ë ¬ì€ left ìœ ì§€ */
        }
        #comparison-display .label { font-weight: 600; margin-bottom: 8px; }
        #comparison-display .comp-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        #comparison-display .comp-value { 
            font-weight: 500;
            font-variant-numeric: tabular-nums;
            /* --- [ìˆ˜ì •ëœ CSS] --- */
            text-align: right; /* ê°’ë§Œ ëª…ì‹œì ìœ¼ë¡œ ìš°ì¸¡ ì •ë ¬ */
            /* ------------------- */
        }
        
        .schedule-container { 
            margin-top: 20px; 
            border-top: 1px solid #ddd; 
            padding-top: 15px; 
            text-align: left; 
        }
        .schedule-container .label { 
            font-weight: 500; 
            color: #555; 
            font-size: 1rem; 
            margin-bottom: 10px; }
        #payment-schedule-list { 
            max-height: 300px; 
            overflow-y: auto; 
            border: 1px solid #ddd; 
            border-radius: 5px; 
            background-color: #fff; 
            scrollbar-width: thin; 
            scrollbar-color: #ccc #f1f1f1; 
        }
        .schedule-header, .schedule-row { 
            display: grid; 
            grid-template-columns: 1fr 2fr 2fr 2fr 2.5fr; 
            gap: 5px; 
            padding: 8px 10px; 
            font-size: 0.85rem; 
            font-variant-numeric: tabular-nums; }
        .schedule-header { 
            font-weight: 600; 
            background-color: #f9f9f9; 
            border-bottom: 1px solid #ddd; 
            position: sticky; 
            top: 0; }
        .schedule-row { border-bottom: 1px solid #eee; }
        .schedule-header span, .schedule-row span { text-align: right; }
        .schedule-header span:first-child, .schedule-row span:first-child { text-align: right; font-weight: 600; }


        .disclaimer-warning {
            /* display: none; ì œê±° - JSë¡œ ì œì–´í•˜ì§€ ì•Šê³  í•­ìƒ ë³´ì´ë„ë¡ */
            margin-top: 30px; 
            padding: 15px;
            border: 1px solid #ffc107; 
            background-color: #fffbe5; 
            border-radius: 8px;
            font-size: 0.85rem;
            color: #856404;
            text-align: left;
            line-height: 1.4;
        }

        .site-footer {
            color: #888;
            font-size: 0.95rem;
            font-family: 'Segoe UI', Arial, sans-serif;
            text-align: center;
            margin-top: 30px;
            letter-spacing: 0.02em;
        }
        .site-footer p {
            margin: 0;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>ğŸ¦ ëŒ€ì¶œ ì´ì ê³„ì‚°ê¸°</h1>
        
        <div class="calculator-form">
            <div class="input-group">
                <label for="calc-type">ìƒí™˜ ë°©ì‹</label>
                <div class="input-field">
                    <select id="calc-type">
                        <option value="equal-payment">ì›ë¦¬ê¸ˆ ê· ë“±ìƒí™˜</option>
                        <option value="equal-principal">ì›ê¸ˆ ê· ë“±ìƒí™˜</option>
                    </select>
                </div>
            </div>
            <div class="input-group">
                <label for="loan-amount">ëŒ€ì¶œ ì´ ê¸ˆì•¡</label>
                <div class="input-field">
                    <input type="number" id="loan-amount" value="100000000" step="1000000">
                    <span class="unit">ì›</span>
                </div>
            </div>
            <div class="input-group">
                <label for="annual-rate">ì—° ì´ììœ¨</label>
                <div class="input-field">
                    <input type="number" id="annual-rate" value="5" step="0.1">
                    <span class="unit">%</span>
                </div>
            </div>
            <div class="input-group">
                <label for="loan-years">ìƒí™˜ ê¸°ê°„</label>
                <div class="input-field">
                    <input type="number" id="loan-years" value="10" step="1" min="1">
                    <span class="unit">ë…„</span>
                </div>
            </div>
            <div class="input-group">
                <label for="grace-months">ì›ê¸ˆ ë‚©ë¶€ ìœ ì˜ˆê¸°ê°„ (ê±°ì¹˜ê¸°ê°„)</label>
                <div class="input-field">
                    <input type="number" id="grace-months" value="0" step="1" min="0">
                    <span class="unit">ê°œì›”</span>
                </div>
            </div>
            <button id="calculate-btn">ê³„ì‚°í•˜ê¸°</button>
        </div>

        <div id="result-display">
            <div class="result-row">
                <span class="label">ì´ ì›ê¸ˆ</span>
                <span class="value" id="result-principal">0 ì›</span>
            </div>
            <div class="result-row">
                <span class="label">ì´ ì´ì</span>
                <span class="value" id="result-interest">0 ì›</span>
            </div>
            <div class="result-row result-total">
                <span class="label">ì´ ìƒí™˜ ê¸ˆì•¡</span>
                <span class="value" id="result-total">0 ì›</span>
            </div>
            <div class="schedule-container">
                <span class="label">ì›” ìƒí™˜ê¸ˆ ìƒì„¸</span>
                <div class="schedule-header">
                    <span>íšŒì°¨</span>
                    <span>ìƒí™˜ ì›ê¸ˆ</span>
                    <span>ë‚©ë¶€ ì´ì</span>
                    <span>ì›” ë‚©ì…ì•¡</span>
                    <span>ëŒ€ì¶œ ì”ì•¡</span>
                </div>
                <div id="payment-schedule-list">
                    </div>
            </div>
            <div id="comparison-display">
                <div class="label" id="comparison-label">(ì°¸ê³ : ì›ê¸ˆ ê· ë“±ìƒí™˜ ì‹œ)</div>
                <div class="comp-row">
                    <span>ì´ ì´ì ì°¨ì•¡:</span>
                    <span class="comp-value" id="comparison-interest">0 ì›</span>
                </div>
                <div class="comp-row">
                    <span>ì´ ìƒí™˜ ê¸ˆì•¡:</span>
                    <span class="comp-value" id="comparison-total-amount">0 ì›</span>
                </div>
            </div>
        </div>

        <div id="disclaimer-warning" class="disclaimer-warning">
            âš ï¸ **ì£¼ì˜: ë³¸ ê³„ì‚° ê²°ê³¼ëŠ” ë‹¨ìˆœ ì°¸ê³  ëª©ì ìœ¼ë¡œ ì œê³µë©ë‹ˆë‹¤.** <br>
            ì‹¤ì œ ëŒ€ì¶œ ìƒí’ˆì˜ ìˆ˜ìˆ˜ë£Œ, ì„¸ê¸ˆ, ì¼í•  ê³„ì‚° ë°©ì‹ ë“± ë³µì¡í•œ ìš”ì†Œë¥¼ ë°˜ì˜í•˜ì§€ ì•Šì€ ì„ì˜ì˜ ê³„ì‚°ì‹ì— ê¸°ë°˜í•©ë‹ˆë‹¤. <br>
            ì •í™•í•œ ìƒí™˜ ì¼ì • ë° ê¸ˆì•¡ì€ ë°˜ë“œì‹œ ëŒ€ì¶œì„ ì§„í–‰í•˜ëŠ” **ê¸ˆìœµ ê¸°ê´€ì— í™•ì¸**í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.
        </div>
    </div>

    <footer class="site-footer">
        <p>&copy; 2025 jeju-mandarin. Hosted on GitHub Pages.</p>
    </footer>

    <script>
        // 1. í•„ìš”í•œ HTML ìš”ì†Œ ì„ íƒ
        const calcTypeSelect = document.getElementById('calc-type');
        const loanAmountInput = document.getElementById('loan-amount');
        const annualRateInput = document.getElementById('annual-rate');
        const loanYearsInput = document.getElementById('loan-years');
        const graceMonthsInput = document.getElementById('grace-months');
        const calculateBtn = document.getElementById('calculate-btn');
        const resultDisplay = document.getElementById('result-display');
        
        const principalEl = document.getElementById('result-principal');
        const interestEl = document.getElementById('result-interest');
        const totalEl = document.getElementById('result-total');
        const scheduleListEl = document.getElementById('payment-schedule-list');

        const comparisonDisplay = document.getElementById('comparison-display');
        const comparisonLabel = document.getElementById('comparison-label');
        const comparisonInterest = document.getElementById('comparison-interest');
        const comparisonTotalAmount = document.getElementById('comparison-total-amount');

        const disclaimerWarningEl = document.getElementById('disclaimer-warning');


        // 2. í—¬í¼ í•¨ìˆ˜
        function formatToWon(number, showSign = false) {
            const rounded = Math.round(number);
            let str = rounded.toLocaleString('ko-KR') + ' ì›';
            if (showSign) {
                if (rounded > 0) str = `+ ${str}`;
                else if (rounded < 0) str = `- ${Math.abs(rounded).toLocaleString('ko-KR')} ì›`;
                else str = `(ì°¨ì´ ì—†ìŒ)`;
            }
            return str;
        }

        // 3. ì›ë¦¬ê¸ˆ ê· ë“± ê³„ì‚° í•¨ìˆ˜
        function calculateEqualPayment(principal, monthlyRate, totalMonths, graceMonths, paymentMonths) {
            let totalInterest = 0;
            let currentBalance = principal;
            let scheduleHtml = '';
            let fixedMonthlyPayment = 0;

            if (monthlyRate === 0) {
                fixedMonthlyPayment = (paymentMonths > 0) ? principal / paymentMonths : 0;
            } else {
                const power = Math.pow(1 + monthlyRate, paymentMonths);
                fixedMonthlyPayment = (paymentMonths > 0) ? (principal * ( (monthlyRate * power) / (power - 1) )) : 0;
            }

            for (let i = 1; i <= totalMonths; i++) {
                const interestForMonth = currentBalance * monthlyRate;
                totalInterest += interestForMonth;
                
                let principalForMonth = 0;
                let totalPaymentForMonth = 0;

                if (i <= graceMonths) {
                    principalForMonth = 0;
                    totalPaymentForMonth = interestForMonth;
                } else {
                    principalForMonth = fixedMonthlyPayment - interestForMonth;
                    totalPaymentForMonth = fixedMonthlyPayment;
                    currentBalance -= principalForMonth; 
                }
                
                if (i === totalMonths && currentBalance > -1 && currentBalance < 1) {
                    principalForMonth += currentBalance;
                    totalPaymentForMonth += currentBalance;
                    currentBalance = 0;
                }

                scheduleHtml += `
                    <div class="schedule-row">
                        <span>${i}íšŒ</span>
                        <span>${formatToWon(principalForMonth)}</span>
                        <span>${formatToWon(interestForMonth)}</span>
                        <span>${formatToWon(totalPaymentForMonth)}</span>
                        <span>${formatToWon(currentBalance)}</span>
                    </div>
                `;
            }
            return { totalInterest, totalRepayment: principal + totalInterest, scheduleHtml };
        }

        // 4. ì›ê¸ˆ ê· ë“± ê³„ì‚° í•¨ìˆ˜
        function calculateEqualPrincipal(principal, monthlyRate, totalMonths, graceMonths, paymentMonths) {
            let totalInterest = 0;
            let currentBalance = principal;
            let scheduleHtml = '';
            const fixedPrincipalPayment = (paymentMonths > 0) ? principal / paymentMonths : 0;

            for (let i = 1; i <= totalMonths; i++) {
                const interestForMonth = currentBalance * monthlyRate;
                totalInterest += interestForMonth;
                
                let principalForMonth = 0;

                if (i > graceMonths) {
                    principalForMonth = fixedPrincipalPayment;
                    currentBalance -= principalForMonth;
                }
                
                const totalPaymentForMonth = principalForMonth + interestForMonth;

                if (i === totalMonths && currentBalance > -1 && currentBalance < 1) {
                    principalForMonth += currentBalance;
                    currentBalance = 0;
                }
                
                scheduleHtml += `
                    <div class="schedule-row">
                        <span>${i}íšŒ</span>
                        <span>${formatToWon(principalForMonth)}</span>
                        <span>${formatToWon(interestForMonth)}</span>
                        <span>${formatToWon(totalPaymentForMonth)}</span>
                        <span>${formatToWon(currentBalance)}</span>
                    </div>
                `;
            }
            return { totalInterest, totalRepayment: principal + totalInterest, scheduleHtml };
        }

        // 5. ê³„ì‚°í•˜ê¸° ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
        calculateBtn.addEventListener('click', function() {
            
            const calcType = calcTypeSelect.value;
            const principal = parseFloat(loanAmountInput.value);
            const annualRate = parseFloat(annualRateInput.value) / 100;
            const years = parseFloat(loanYearsInput.value);
            const graceMonths = parseFloat(graceMonthsInput.value);
            
            const monthlyRate = annualRate / 12;
            const totalMonths = years * 12;
            const paymentMonths = totalMonths - graceMonths; 

            if (isNaN(principal) || isNaN(annualRate) || isNaN(years) || isNaN(graceMonths) ||
                principal <= 0 || annualRate < 0 || years <= 0 || graceMonths < 0) {
                alert("ìœ íš¨í•œ ê°’ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }
            if (paymentMonths <= 0) {
                alert("ìƒí™˜ ê¸°ê°„ì€ ìœ ì˜ˆê¸°ê°„ë³´ë‹¤ ê¸¸ì–´ì•¼ í•©ë‹ˆë‹¤.");
                return;
            }

            const equalPaymentResult = calculateEqualPayment(principal, monthlyRate, totalMonths, graceMonths, paymentMonths);
            const equalPrincipalResult = calculateEqualPrincipal(principal, monthlyRate, totalMonths, graceMonths, paymentMonths);
            
            let mainResult, comparisonResult, comparisonLabelText;

            if (calcType === 'equal-payment') {
                mainResult = equalPaymentResult;
                comparisonResult = equalPrincipalResult;
                comparisonLabelText = "(ì°¸ê³ : ì›ê¸ˆ ê· ë“±ìƒí™˜ ì‹œ)";
            } else {
                mainResult = equalPrincipalResult;
                comparisonResult = equalPaymentResult;
                comparisonLabelText = "(ì°¸ê³ : ì›ë¦¬ê¸ˆ ê· ë“±ìƒí™˜ ì‹œ)";
            }

            const interestDifference = comparisonResult.totalInterest - mainResult.totalInterest;
            
            principalEl.textContent = formatToWon(principal);
            interestEl.textContent = formatToWon(mainResult.totalInterest);
            totalEl.textContent = formatToWon(mainResult.totalRepayment);
            
            scheduleListEl.innerHTML = mainResult.scheduleHtml;
            
            comparisonLabel.textContent = comparisonLabelText;
            comparisonInterest.textContent = formatToWon(interestDifference, true);
            comparisonTotalAmount.textContent = formatToWon(comparisonResult.totalRepayment, false);

            resultDisplay.style.display = 'block';
            disclaimerWarningEl.style.display = 'block';
        });

    </script>

</body>
</html>